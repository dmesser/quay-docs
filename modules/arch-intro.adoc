[[arch-intro]]
= {productname} overview

{productname} is a trusted, open source container registry platform that runs everywhere, but runs best on Red Hat OpenShift. It scales without limits, from a developer laptop to a container host or Kubernetes, and can be deployed on-prem or on public cloud. {productname} provides global governance and security controls, with features including image vulnerability scanning, access controls, geo-replication and repository mirroring.

image:178_Quay_architecture_0821_features.png[Quay features]

This guide provides an insight into architectural patterns to use when deploying {productname}. It contains sizing guidance and deployment prerequisites, along with best practices for ensuring high availability for your {productname} registry. 



== Scalability and high availability (HA)

The code base for the self-managed {productname} offering is substantially the same as that used for link:https::/quay.io[quay.io], the highly available container image registry hosted by Red Hat which provides a multi-tenant SaaS solution. As a result, you can be confident that {productname} can deliver at scale with high availability, whether you deploy on-prem or on public cloud.
{productname} relies on additional services like load balancers, in-memory caches and relational databases that in turn need to be provided in a highly-available fashion in order for the full stack to be considered highly-available. In some scenarios these have to be provided by the customer, depending on the desired service level objective (SLO).

== Security

{productname} is built for enterprise use cases where content governance and security are two major focus areas. {productname} content governance is provided by a granular access control model and rich automation capabilities with the {productname} API while built-in vulnerability scanning via Clair adds introspection capabilities into stored image content for security analysis.

== Content distribution 

Content distribution features in {productname} include:

Repository mirroring:: {productname} repository mirroring lets you mirror images from external container registries (or another local registry) into your {productname} cluster. Using repository mirroring, you can synchronize images to {productname} based on repository names and tags.

Geo-replication:: {productname} geo-replication allows multiple, geographically distributed Quay deployments to work as a single registry from the perspective of a client or user. It significantly improves push and pull performance in a globally-distributed {productname} setup. Image data is asynchronously replicated in the background with transparent redirect for clients for data that is not yet replicated.

Proxy-Pull-Thru Caching (Tech Preview):: {productname} allows to integrate external OCI-compliant container registries via a caching layers that provides a transparent way for clients to pull content from third party registries through {productname}. This benefits performance of subsequent pulls due to caching and provides the ability to granularly mediate access to otherwise unstrusted registries at the level of a particular namespace versus the entire registry.

Deployment in disconnected or air-gapped environments:: {productname} can be deployed in a disconnected environment in three ways:
+
* {productname} connected to the public internet, with an air-gapped OpenShift cluster accessing the  registry in a demilitarized network zone.
* {productname} is connected to public the internet via an HTTP(S) proxy, with an air-gapped or proxied Openshift cluster accessing the registry directly
* {productname} running inside the firewall, with image and CVE data transferred to the registry system using offline media. The data is exported from a system is connected to the internet.

== Access control and multi-tenancy

{productname} provides both role-based access control (RBAC) and fine-grained access control, and has a tenancy model that allow for group-based access control for repositories inside organizations. {productname} supports a hard tenancy model for dispersed organizations.

== Quota management

In addition to strict tenant separation {productname} enables large multi-tenant deployments while maintaining storage growth by the use of a storage quota system. Administrators can define a system-wide default quota and specify quota for individual tenants with variable degree of enforcement.

== Build automation

{productname} supports building Dockerfiles using build job orchestration on OpenShift or Kubernetes. Build triggers, such as GitHub or GitLab webhooks, can be configured to automatically build new versions of your repositories when new code is committed.

Prior to {productname} 3.7, builds ran in by containerized virtual machines, requiring bare-metal OpenShift or Kubernetes clusters. With {productname} 3.7 or newer an additional build option was introduced that is purely based on containerized build environment leveraging buildah which does not need a virtual machine layer. As a result, builds can be run virtual or cloud-based OpenShift or Kubernetes clusters.

== Integration

Integration with popular source code management and versioning systems like GitHub, GitLab or BitBucket allows {productname} to continuously build and serve your containerized software. Event-based webhook support is available to create rich automation with external API-driven systems, for instance when tags become available or security scans yield vulnerabilites above a certain threshold.

== REST API

{productname} provides a full OAuth2-enabled RESTful API that:

* Is available from endpoints of each {productname} instance from the URL https://<yourquayhost>/api/v1
* Lets you connect to endpoints, via a browser, to get, delete, post, and put {productname} settings by enabling the Swagger UI
* Can be accessed by applications that make API calls and use OAuth tokens
* Sends and receives data as JSON

== Other features

* Full standards / spec support (Docker v2-2, OCI)
* Long-term protocol support
* OCI compatibility through test suite compliance
* Enterprise grade support
* Regular updates 